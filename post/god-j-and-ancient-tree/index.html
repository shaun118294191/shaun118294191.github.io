<html>
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>God J and Ancient Tree | Shaun</title>
<link rel="shortcut icon" href="https://shaun118294191.github.io/favicon.ico?v=1586329214313">
<link href="https://cdn.jsdelivr.net/npm/remixicon@2.3.0/fonts/remixicon.css" rel="stylesheet">
<link rel="stylesheet" href="https://shaun118294191.github.io/styles/main.css">
<link rel="alternate" type="application/atom+xml" title="God J and Ancient Tree | Shaun - Atom Feed" href="https://shaun118294191.github.io/atom.xml">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700">



    <meta name="description" content="题目链接
In The World of Code, there are three gods who keep the world running, and God J is one of them. In the garden of G..." />
    <meta name="keywords" content="trie树合并,dsu,trie" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
    <script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
  </head>
  <body>
    <div class="main">
      <div class="main-content">
        <div class="site-header">
  <a href="https://shaun118294191.github.io">
  <img class="avatar" src="https://shaun118294191.github.io/images/avatar.png?v=1586329214313" alt="">
  </a>
  <h1 class="site-title">
    Shaun
  </h1>
  <p class="site-description">
    Valar morghulis Valar Dohaeris
  </p>
  <div class="menu-container">
    
      
        <a href="/" class="menu">
          首页
        </a>
      
    
      
        <a href="/archives" class="menu">
          归档
        </a>
      
    
      
        <a href="/tags" class="menu">
          标签
        </a>
      
    
      
        <a href="/post/about" class="menu">
          关于
        </a>
      
    
  </div>
  <div class="social-container">
    
      
    
      
    
      
    
      
    
      
    
  </div>
</div>

        <div class="post-detail">
          <article class="post">
            <h2 class="post-title">
              God J and Ancient Tree
            </h2>
            <div class="post-info">
              <span>
                2020-03-27
              </span>
              <span>
                5 min read
              </span>
              
                <a href="https://shaun118294191.github.io/tag/H2B2eCDOx/" class="post-tag">
                  # trie树合并
                </a>
              
                <a href="https://shaun118294191.github.io/tag/Dy3oT16zO7/" class="post-tag">
                  # dsu
                </a>
              
                <a href="https://shaun118294191.github.io/tag/KNsjxfA7_/" class="post-tag">
                  # trie
                </a>
              
            </div>
            
            <div class="post-content-wrapper">
              <div class="post-content">
                <p><a href="https://www.luogu.com.cn/problem/T125991">题目链接</a></p>
<p>In The World of Code, there are three gods who keep the world running, and God J is one of them. In the garden of God J, an ancient tree grows. This tree can be represented as an undirected graph with nn nodes and n-1 edges. Nodes are numbered through 1 to n, where node 1 is called the root. Node i has <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> mysterious points.</p>
<p>As this ancient tree grows, God J is going to prone some parts of it. In particular, God J will choose two nodes x and y (probably the same). After that he will delete those nodes which are neither on the shortest path from the root to node x, nor on the shortest path from the root to node y. The remaining tree is &quot;Y&quot;-shaped, or even simpler. The final score is the bitwise xor sum of all mysterious points of the remaining nodes.</p>
<p>Your job is to help God J choose the two nodes, in order to maximize the final score.</p>
<p>Recall that the bitwise xor sum of a set of numbers a,b,c,… is a⊕b⊕c⊕…, where ⊕ stands for bitwise xor.</p>
<p>In the first sample down below if you choose node 4 and 5 the red nodes will remain and you will get the final score up to 128⊕48⊕4⊕8=188.<br>
<img src="https://shaun118294191.github.io/post-images/1585312803512.png" alt="" loading="lazy"></p>
<p>跟新中...<br>
Code:</p>
<pre><code class="language-cpp">#include &lt;bits/stdc++.h&gt;
using namespace std;

template &lt;typename T&gt; inline void read(T &amp;x) {
    int f = 1;
    x = 0;
    char ch = getchar();
    while (!isdigit(ch)) f = (ch == '-') ? -1 : 1, ch = getchar();
    while (isdigit(ch)) x = x * 10 + ch - 48, ch = getchar();
    x *= f;
}

constexpr int MAXN = 1e5 + 5;
constexpr int BIT = 31;
struct Trie {
    Trie *son[2];
}Tree[MAXN * BIT &lt;&lt; 2], *root[MAXN];
using A = int [MAXN];
using Node = Trie *;
int n, ans;
A w, dis, sz, son, father;

inline Node newNode(Node &amp;root) {
    static int nptr;
    return root ? root : root = &amp;Tree[++nptr];
}

inline void insert(Node root, int x) {
    for (int i = BIT, tmp; ~i; i--) {
        tmp = (x &gt;&gt; i) &amp; 1;
        root = newNode(root-&gt;son[tmp]);
    }
}

inline void merge(Node pre, Node &amp;root) {
    if (root == NULL) {root = pre; return;}
    if (pre == NULL) return;
    merge(pre-&gt;son[0], root-&gt;son[0]);
    merge(pre-&gt;son[1], root-&gt;son[1]);
}

inline void search(Node root, int x, int fa) {
    int res = 0;
    for (int i = BIT, tmp; ~i; i--) {
        tmp = (x &gt;&gt; i) &amp; 1;
        if (root-&gt;son[tmp ^ 1]) root = root-&gt;son[tmp ^ 1], res |= (1 &lt;&lt; i);
        else root = root-&gt;son[tmp];
    }
    ans = max(ans, res);
}

vector&lt;int&gt; G[MAXN];
inline void dfs(int cur, int fa) {
    dis[cur] = (dis[fa] ^ w[cur]);
    father[cur] = fa, sz[cur] = 1, son[cur] = 0;
    for (auto &amp;to : G[cur]) {
        if (fa == to) continue;
        dfs(to, cur);
        sz[cur] += sz[to];
        if (!son[cur] || sz[son[cur]] &lt; sz[to]) son[cur] = to; //重儿子
    }
}

inline void dfs3(int fa, int cur) {
    search(root[fa], dis[cur] ^ dis[fa], fa);
    for (auto &amp;to : G[cur]) {
        if (to == father[cur]) continue;
        dfs3(fa, to);
    }
    merge(root[cur], root[fa]);
}

inline void dfs2(int cur) {
    for (auto &amp;to : G[cur]) {
        if (to == father[cur]) continue;
        if (son[cur] == to) dfs2(to), merge(root[to], root[cur]);
    }
    for (auto &amp;to : G[cur]) {
        if (to == father[cur] || to == son[cur]) continue;
        dfs3(cur, to);
        dfs2(to);
    }
}

int main() {
    read(n);
    for (int i = 1; i &lt;= n; i++) read(w[i]);
    for (int i = 1, u, v; i &lt; n; i++) {
        read(u), read(v);
        G[u].emplace_back(v), G[v].emplace_back(u);
    }
    dfs(1, 0);
    for (int i = 1; i &lt;= n; i++)
        ans = max(ans, dis[i]), newNode(root[i]), insert(root[i], dis[i]);
    dfs2(1);
    cout &lt;&lt; ans &lt;&lt; endl;
    return 0;
}
</code></pre>

              </div>
              <div class="toc-container">
                
              </div>
            </div>
          </article>
        </div>

        
          <div class="next-post">
            <div class="next">下一篇</div>
            <a href="https://shaun118294191.github.io/post/cf600e-lomsat-gelral/">
              <h3 class="post-title">
                CF600E Lomsat gelral
              </h3>
            </a>
          </div>
        

        

        <div class="site-footer">
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a>
  <a class="rss" href="https://shaun118294191.github.io/atom.xml" target="_blank">
    <i class="ri-rss-line"></i> RSS
  </a>
</div>

      </div>
    </div>

    <script>
      hljs.initHighlightingOnLoad()

      let mainNavLinks = document.querySelectorAll(".markdownIt-TOC a");

      // This should probably be throttled.
      // Especially because it triggers during smooth scrolling.
      // https://lodash.com/docs/4.17.10#throttle
      // You could do like...
      // window.addEventListener("scroll", () => {
      //    _.throttle(doThatStuff, 100);
      // });
      // Only not doing it here to keep this Pen dependency-free.

      window.addEventListener("scroll", event => {
        let fromTop = window.scrollY;

        mainNavLinks.forEach((link, index) => {
          let section = document.getElementById(decodeURI(link.hash).substring(1));
          let nextSection = null
          if (mainNavLinks[index + 1]) {
            nextSection = document.getElementById(decodeURI(mainNavLinks[index + 1].hash).substring(1));
          }
          if (section.offsetTop <= fromTop) {
            if (nextSection) {
              if (nextSection.offsetTop > fromTop) {
                link.classList.add("current");
              } else {
                link.classList.remove("current");    
              }
            } else {
              link.classList.add("current");
            }
          } else {
            link.classList.remove("current");
          }
        });
      });

    </script>
  </body>
</html>
